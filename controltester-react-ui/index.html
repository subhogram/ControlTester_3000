<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ControlTester 3000 - Cybersecurity Audit Platform</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header__content">
                <!-- Mobile/Desktop Sidebar Toggle -->
                <button class="sidebar__toggle-header" id="sidebar-toggle-header" aria-label="Toggle Sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="header__brand">
                    <i class="fas fa-shield-alt"></i>
                    <h1>ControlTester 3000</h1>
                </div>
                <div class="header__actions">
                    <button class="btn btn--outline btn--sm" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="app-layout">
            <!-- Collapsible Sidebar -->
            <aside class="sidebar" id="sidebar">
                <nav class="sidebar__nav">
                    <a href="#" class="sidebar__link active" data-section="dashboard" title="Main Dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="sidebar__link" data-section="workflow" title="Step-by-step Audit Process">
                        <i class="fas fa-tasks"></i>
                        <span>Audit Workflow</span>
                    </a>
                    <a href="#" class="sidebar__link" data-section="results" title="Assessment Results">
                        <i class="fas fa-chart-bar"></i>
                        <span>Results</span>
                    </a>
                    <a href="#" class="sidebar__link" data-section="chat" title="Chat with AI Assistant">
                        <i class="fas fa-comments"></i>
                        <span>AI Assistant</span>
                    </a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="main-content" id="main-content">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section active">
                    <div class="section__header">
                        <h2>Cybersecurity Audit Dashboard</h2>
                        <p class="section__subtitle">Comprehensive security assessment and compliance monitoring</p>
                    </div>

                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card__body">
                                <div class="stat">
                                    <div class="stat__icon stat__icon--success">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="stat__content">
                                        <div class="stat__value">85%</div>
                                        <div class="stat__label">Compliance Rate</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card__body">
                                <div class="stat">
                                    <div class="stat__icon stat__icon--warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="stat__content">
                                        <div class="stat__value">12</div>
                                        <div class="stat__label">Medium Risk Issues</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card__body">
                                <div class="stat">
                                    <div class="stat__icon stat__icon--error">
                                        <i class="fas fa-times-circle"></i>
                                    </div>
                                    <div class="stat__content">
                                        <div class="stat__value">3</div>
                                        <div class="stat__label">High Risk Issues</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card__body">
                                <div class="stat">
                                    <div class="stat__icon stat__icon--info">
                                        <i class="fas fa-file-alt"></i>
                                    </div>
                                    <div class="stat__content">
                                        <div class="stat__value">47</div>
                                        <div class="stat__label">Controls Assessed</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-8">
                        <div class="card__body">
                            <h3>Quick Start</h3>
                            <p>Begin your security audit by following the step-by-step workflow process. Sample files are pre-loaded for demonstration purposes.</p>
                            <button class="btn btn--primary mt-8" data-action="start-audit">
                                Start New Audit
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Workflow Section -->
                <section id="workflow" class="section">
                    <div class="section__header">
                        <h2>Audit Workflow</h2>
                        <p class="section__subtitle">Follow the step-by-step process to complete your security assessment</p>
                    </div>

                    <!-- Stepper -->
                    <div class="stepper">
                        <div class="stepper__step active" data-step="1">
                            <div class="stepper__icon">ü§ñ</div>
                            <div class="stepper__content">
                                <div class="stepper__title">Model Selection</div>
                                <div class="stepper__description">Choose Ollama model for processing</div>
                            </div>
                        </div>
                        <div class="stepper__step" data-step="2">
                            <div class="stepper__icon">üìö</div>
                            <div class="stepper__content">
                                <div class="stepper__title">Knowledge Base</div>
                                <div class="stepper__description">Upload security policies and standards</div>
                            </div>
                        </div>
                        <div class="stepper__step" data-step="3">
                            <div class="stepper__icon">üè¢</div>
                            <div class="stepper__content">
                                <div class="stepper__title">Company Documents</div>
                                <div class="stepper__description">Upload SOC reports and company policies</div>
                            </div>
                        </div>
                        <div class="stepper__step" data-step="4">
                            <div class="stepper__icon">üîç</div>
                            <div class="stepper__content">
                                <div class="stepper__title">Evidence Files</div>
                                <div class="stepper__description">Upload logs, configs, and evidence</div>
                            </div>
                        </div>
                        <div class="stepper__step" data-step="5">
                            <div class="stepper__icon">üìä</div>
                            <div class="stepper__content">
                                <div class="stepper__title">Assessment & Results</div>
                                <div class="stepper__description">Review audit results and generate reports</div>
                            </div>
                        </div>
                    </div>

                    <!-- Step Content -->
                    <div class="workflow-content">
                        <!-- Step 1: Model Selection -->
                        <div class="step-content active" id="step-1">
                            <div class="card">
                                <div class="card__body">
                                    <h3>Select Ollama Model</h3>
                                    <p>Choose the AI model that will process your audit documents and evidence. Default model is pre-selected for quick start.</p>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Available Models</label>
                                        <select class="form-control" id="model-select">
                                            <option value="">Select a model...</option>
                                            <option value="llama3.2:latest" selected>Llama 3.2 (Latest)</option>
                                            <option value="mistral:latest">Mistral (Latest)</option>
                                            <option value="codellama:latest">CodeLlama (Latest)</option>
                                            <option value="tinyllama:latest">TinyLlama (Latest)</option>
                                        </select>
                                    </div>

                                    <div class="step-actions">
                                        <button class="btn btn--primary" data-action="next-step" data-step="2" id="step-1-next">
                                            Next Step
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Knowledge Base Upload -->
                        <div class="step-content" id="step-2">
                            <div class="card">
                                <div class="card__body">
                                    <h3>Upload Knowledge Base Documents</h3>
                                    <p>Upload your security policies, standards, and compliance frameworks. Sample files are pre-loaded for demonstration.</p>
                                    
                                    <div class="file-upload-zone" id="kb-upload">
                                        <div class="file-upload-zone__content">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                            <h4>Drag and drop files here</h4>
                                            <p>Or click to browse files</p>
                                            <small>Supported formats: PDF, TXT, CSV, XLSX</small>
                                        </div>
                                        <input type="file" multiple accept=".pdf,.txt,.csv,.xlsx" class="file-input">
                                    </div>

                                    <div class="uploaded-files" id="kb-files"></div>

                                    <div class="step-actions">
                                        <button class="btn btn--outline" data-action="prev-step" data-step="1">Previous</button>
                                        <button class="btn btn--primary" data-action="next-step" data-step="3" id="step-2-next">
                                            Next Step
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Company Documents Upload -->
                        <div class="step-content" id="step-3">
                            <div class="card">
                                <div class="card__body">
                                    <h3>Upload Company Documents</h3>
                                    <p>Upload your SOC 2 reports, CRI profiles, and other company-specific documents. Sample files are pre-loaded for demonstration.</p>
                                    
                                    <div class="file-upload-zone" id="company-upload">
                                        <div class="file-upload-zone__content">
                                            <i class="fas fa-building"></i>
                                            <h4>Drag and drop files here</h4>
                                            <p>Or click to browse files</p>
                                            <small>Supported formats: PDF, TXT, CSV, XLSX</small>
                                        </div>
                                        <input type="file" multiple accept=".pdf,.txt,.csv,.xlsx" class="file-input">
                                    </div>

                                    <div class="uploaded-files" id="company-files"></div>

                                    <div class="step-actions">
                                        <button class="btn btn--outline" data-action="prev-step" data-step="2">Previous</button>
                                        <button class="btn btn--primary" data-action="next-step" data-step="4" id="step-3-next">
                                            Next Step
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4: Evidence Files Upload -->
                        <div class="step-content" id="step-4">
                            <div class="card">
                                <div class="card__body">
                                    <h3>Upload Evidence Files</h3>
                                    <p>Upload logs, configurations, screenshots, and other evidence for assessment. Sample files are pre-loaded for demonstration.</p>
                                    
                                    <div class="file-upload-zone" id="evidence-upload">
                                        <div class="file-upload-zone__content">
                                            <i class="fas fa-search"></i>
                                            <h4>Drag and drop files here</h4>
                                            <p>Or click to browse files</p>
                                            <small>Supported formats: PDF, TXT, CSV, XLSX, JPEG, JPG</small>
                                        </div>
                                        <input type="file" multiple accept=".pdf,.txt,.csv,.xlsx,.jpeg,.jpg" class="file-input">
                                    </div>

                                    <div class="uploaded-files" id="evidence-files"></div>

                                    <div class="step-actions">
                                        <button class="btn btn--outline" data-action="prev-step" data-step="3">Previous</button>
                                        <button class="btn btn--primary" data-action="process-assessment" id="step-4-next">
                                            Process Assessment
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 5: Assessment Results -->
                        <div class="step-content" id="step-5">
                            <div class="card">
                                <div class="card__body">
                                    <h3>Assessment Processing</h3>
                                    <p>Your security audit is being processed using the corrected API integration with proper parameter names and single endpoint call.</p>
                                    
                                    <div class="processing-status" id="processing-status" style="display: none;">
                                        <div class="progress-bar">
                                            <div class="progress-bar__fill"></div>
                                        </div>
                                        <p>Processing assessment with /assess-evidence endpoint...</p>
                                        <small>Using evidence_files, global_kb_files, and company_kb_files parameters</small>
                                    </div>

                                    <div class="step-actions">
                                        <button class="btn btn--outline" data-action="prev-step" data-step="4">Previous</button>
                                        <button class="btn btn--primary" data-action="view-results">
                                            View Detailed Results
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Results Section -->
                <section id="results" class="section">
                    <div class="section__header">
                        <h2>Assessment Results</h2>
                        <p class="section__subtitle">Detailed security audit findings and recommendations</p>
                    </div>

                    <div class="results-grid">
                        <div class="card">
                            <div class="card__body">
                                <h3>Access Control Policy</h3>
                                <div class="status status--success">COMPLIANT</div>
                                <div class="result-details">
                                    <p><strong>Risk Level:</strong> LOW</p>
                                    <p><strong>Evidence Reviewed:</strong> User access logs, authentication configurations</p>
                                    <p><strong>Findings:</strong> Multi-factor authentication properly implemented</p>
                                    <p><strong>Recommendations:</strong> Continue monitoring access patterns</p>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card__body">
                                <h3>Data Encryption Standards</h3>
                                <div class="status status--warning">PARTIALLY COMPLIANT</div>
                                <div class="result-details">
                                    <p><strong>Risk Level:</strong> MEDIUM</p>
                                    <p><strong>Evidence Reviewed:</strong> Database configurations, network traffic logs</p>
                                    <p><strong>Findings:</strong> Some data transmissions not encrypted</p>
                                    <p><strong>Recommendations:</strong> Implement TLS 1.3 for all data in transit</p>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card__body">
                                <h3>Network Security Controls</h3>
                                <div class="status status--error">NON COMPLIANT</div>
                                <div class="result-details">
                                    <p><strong>Risk Level:</strong> HIGH</p>
                                    <p><strong>Evidence Reviewed:</strong> Firewall configurations, network segmentation logs</p>
                                    <p><strong>Findings:</strong> Critical firewall rules missing, network segmentation inadequate</p>
                                    <p><strong>Recommendations:</strong> Implement proper firewall rules and network segmentation immediately</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-8">
                        <div class="card__body">
                            <h3>Generate Reports</h3>
                            <p>Download comprehensive audit reports and executive summaries based on your assessment results.</p>
                            <div class="flex gap-8 mt-8">
                                <button class="btn btn--primary" data-action="download-report">
                                    <i class="fas fa-download"></i>
                                    Download Full Report
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Chat Section -->
                <section id="chat" class="section">
                    <div class="section__header">
                        <h2>AI Assistant</h2>
                        <p class="section__subtitle">Ask questions about your audit results and get AI-powered insights</p>
                    </div>

                    <div class="chat-container">
                        <div class="chat-messages" id="chat-messages">
                            <div class="chat-message chat-message--assistant">
                                <div class="chat-message__avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="chat-message__content">
                                    <p>Hello! I'm your AI audit assistant. I can help you understand your security assessment results, explain compliance requirements, or answer questions about the evidence you've uploaded. The application now uses the corrected API integration with proper parameter names (evidence_files, global_kb_files, company_kb_files) and the single /assess-evidence endpoint. How can I assist you today?</p>
                                </div>
                            </div>
                        </div>

                        <div class="chat-input-container">
                            <div class="chat-input">
                                <input type="text" placeholder="Ask about your audit results..." id="chat-input">
                                <button class="btn btn--primary" data-action="send-message">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Tooltip element for collapsed sidebar -->
    <div class="tooltip" id="tooltip"></div>

    <script src="app.js"></script>
</body>
</html>